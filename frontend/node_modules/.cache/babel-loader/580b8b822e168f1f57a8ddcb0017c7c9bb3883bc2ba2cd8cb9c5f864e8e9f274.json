{"ast":null,"code":"import React,{useState,useMemo}from'react';import{Box,Typography,Grid,Card,CardContent,Avatar,Chip,Container,CircularProgress,Alert,TextField,InputAdornment,FormControl,InputLabel,Select,MenuItem,Stack,Divider}from'@mui/material';import{SportsFootball,Star,Person,Search,FilterList}from'@mui/icons-material';import{motion}from'framer-motion';import{useQuery}from'@tanstack/react-query';import{useAuth}from'../../hooks/useAuth';import{teamApi}from'../../services/api';import GradientButton from'../../components/ui/GradientButton';import GlassCard from'../../components/ui/GlassCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TeamSelection=()=>{var _teamsData$data;const{selectTeam,user}=useAuth();const[selectedTeam,setSelectedTeam]=useState(null);const[isSubmitting,setIsSubmitting]=useState(false);const[searchTerm,setSearchTerm]=useState('');const[selectedConference,setSelectedConference]=useState('All');const[showHumanOnly,setShowHumanOnly]=useState(false);const{data:teamsData,isLoading,error}=useQuery({queryKey:['teams'],queryFn:()=>teamApi.getAll({size:1000})// Get all teams\n});const{data:conferencesData}=useQuery({queryKey:['conferences'],queryFn:()=>teamApi.getConferences()});// Extract data for use in useMemo\nconst allTeams=(teamsData===null||teamsData===void 0?void 0:(_teamsData$data=teamsData.data)===null||_teamsData$data===void 0?void 0:_teamsData$data.content)||[];const conferences=(conferencesData===null||conferencesData===void 0?void 0:conferencesData.data)||[];// Filter and search teams - moved before early returns\nconst filteredTeams=useMemo(()=>{let filtered=allTeams;// Apply search filter\nif(searchTerm.trim()){const search=searchTerm.toLowerCase();filtered=filtered.filter(team=>{var _team$coach,_team$conference;return team.name.toLowerCase().includes(search)||((_team$coach=team.coach)===null||_team$coach===void 0?void 0:_team$coach.toLowerCase().includes(search))||((_team$conference=team.conference)===null||_team$conference===void 0?void 0:_team$conference.toLowerCase().includes(search));});}// Apply conference filter\nif(selectedConference!=='All'){filtered=filtered.filter(team=>team.conference===selectedConference);}// Apply human-only filter\nif(showHumanOnly){filtered=filtered.filter(team=>team.isHuman);}return filtered;},[allTeams,searchTerm,selectedConference,showHumanOnly]);const handleTeamSelect=team=>{setSelectedTeam(team);};const handleConfirmSelection=async()=>{if(!selectedTeam)return;setIsSubmitting(true);try{selectTeam(selectedTeam);}catch(error){console.error('Error selecting team:',error);}finally{setIsSubmitting(false);}};const containerVariants={initial:{opacity:0},animate:{opacity:1,transition:{staggerChildren:0.1}}};const itemVariants={initial:{y:20,opacity:0},animate:{y:0,opacity:1,transition:{type:'spring',stiffness:300,damping:24}}};if(isLoading){return/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',background:'linear-gradient(135deg, #0a0e27 0%, #1a1d35 50%, #242744 100%)',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsx(CircularProgress,{size:60})});}if(error){return/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',background:'linear-gradient(135deg, #0a0e27 0%, #1a1d35 50%, #242744 100%)',display:'flex',alignItems:'center',justifyContent:'center',p:2},children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:\"Failed to load teams. Please try again.\"})});}return/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',background:'linear-gradient(135deg, #0a0e27 0%, #1a1d35 50%, #242744 100%)',pt:4,pb:selectedTeam?120:4// Extra bottom padding when team is selected\n},children:/*#__PURE__*/_jsx(Container,{maxWidth:\"lg\",children:/*#__PURE__*/_jsxs(motion.div,{variants:containerVariants,initial:\"initial\",animate:\"animate\",children:[/*#__PURE__*/_jsx(motion.div,{variants:itemVariants,children:/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center',mb:6},children:[/*#__PURE__*/_jsx(Avatar,{sx:{width:80,height:80,mx:'auto',mb:2,background:'linear-gradient(135deg, #1e88e5 0%, #42a5f5 100%)'},children:/*#__PURE__*/_jsx(SportsFootball,{fontSize:\"large\"})}),/*#__PURE__*/_jsx(Typography,{variant:\"h3\",sx:{fontWeight:700,mb:1,background:'linear-gradient(135deg, #42a5f5, #66bb6a)',backgroundClip:'text',WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent'},children:\"Choose Your Team\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",color:\"text.secondary\",children:[\"Welcome, \",user===null||user===void 0?void 0:user.username,\"! Select the team you are managing in game.\"]})]})}),/*#__PURE__*/_jsx(motion.div,{variants:itemVariants,children:/*#__PURE__*/_jsx(GlassCard,{sx:{mb:4,p:3},children:/*#__PURE__*/_jsxs(Stack,{spacing:3,children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(FilterList,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:600},children:\"Find Your Team\"}),/*#__PURE__*/_jsx(Chip,{label:\"\".concat(filteredTeams.length,\" teams\"),size:\"small\",color:\"primary\",variant:\"outlined\"})]}),/*#__PURE__*/_jsx(Divider,{sx:{opacity:0.3}}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,sx:{px:2},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:5,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,placeholder:\"Search teams, coaches, or conferences...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(Search,{color:\"action\"})}),sx:{backgroundColor:'rgba(255,255,255,0.05)','& .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255,255,255,0.2)'},'&:hover .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255,255,255,0.3)'}}},sx:{'& .MuiInputLabel-root':{color:'text.secondary'}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{sx:{color:'text.secondary'},children:\"Conference\"}),/*#__PURE__*/_jsxs(Select,{value:selectedConference,onChange:e=>setSelectedConference(e.target.value),label:\"Conference\",sx:{backgroundColor:'rgba(255,255,255,0.05)','& .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255,255,255,0.2)'},'&:hover .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255,255,255,0.3)'}},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"All\",children:\"All Conferences\"}),conferences.map(conference=>/*#__PURE__*/_jsx(MenuItem,{value:conference,children:conference},conference))]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:3,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{sx:{color:'text.secondary'},children:\"Type\"}),/*#__PURE__*/_jsxs(Select,{value:showHumanOnly?'human':'all',onChange:e=>setShowHumanOnly(e.target.value==='human'),label:\"Type\",sx:{backgroundColor:'rgba(255,255,255,0.05)','& .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255,255,255,0.2)'},'&:hover .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255,255,255,0.3)'}},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"all\",children:\"All Teams\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"human\",children:\"Human Only\"})]})]})})]})]})})}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:filteredTeams.length===0?/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center',py:8},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",children:\"No teams found matching your search criteria\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mt:1},children:\"Try adjusting your search or filters\"})]})}):filteredTeams.map((team,index)=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,lg:3,children:/*#__PURE__*/_jsx(motion.div,{variants:itemVariants,whileHover:{scale:1.02},whileTap:{scale:0.98},children:/*#__PURE__*/_jsx(Card,{onClick:()=>handleTeamSelect(team),sx:{cursor:'pointer',height:'100%',display:'flex',flexDirection:'column',background:(selectedTeam===null||selectedTeam===void 0?void 0:selectedTeam.id)===team.id?'linear-gradient(145deg, rgba(30,136,229,0.2) 0%, rgba(66,165,245,0.1) 100%)':'linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)',backdropFilter:'blur(20px)',border:(selectedTeam===null||selectedTeam===void 0?void 0:selectedTeam.id)===team.id?'2px solid #42a5f5':'1px solid rgba(255,255,255,0.1)',borderRadius:'20px',boxShadow:(selectedTeam===null||selectedTeam===void 0?void 0:selectedTeam.id)===team.id?'0 8px 32px rgba(66,165,245,0.3)':'0 8px 32px rgba(0,0,0,0.3)',transition:'all 0.3s ease','&:hover':{transform:'translateY(-4px)',boxShadow:'0 12px 40px rgba(0,0,0,0.4)'}},children:/*#__PURE__*/_jsxs(CardContent,{sx:{p:3,textAlign:'center',flexGrow:1,display:'flex',flexDirection:'column',minHeight:'280px'},children:[/*#__PURE__*/_jsxs(Box,{sx:{mb:'auto'},children:[/*#__PURE__*/_jsx(Avatar,{sx:{width:60,height:60,mx:'auto',mb:2,background:'linear-gradient(135deg, #ff9800 0%, #ffb74d 100%)',fontSize:'1.5rem',fontWeight:700},children:team.name.substring(0,2).toUpperCase()}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:600,mb:1,color:(selectedTeam===null||selectedTeam===void 0?void 0:selectedTeam.id)===team.id?'#42a5f5':'text.primary',lineHeight:1.2,minHeight:'2.4em',// Reserve space for 2 lines\ndisplay:'flex',alignItems:'center',justifyContent:'center'},children:team.name}),/*#__PURE__*/_jsx(Box,{sx:{minHeight:'32px',display:'flex',alignItems:'center',justifyContent:'center',mb:2},children:team.conference?/*#__PURE__*/_jsx(Chip,{label:team.conference,size:\"small\",sx:{background:'linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1))',color:'text.secondary'}}):/*#__PURE__*/_jsx(Box,{sx:{height:'24px'}})// Placeholder for consistent spacing\n})]}),/*#__PURE__*/_jsxs(Box,{sx:{mt:'auto'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mb:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'left'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Record\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",sx:{fontWeight:600},children:[team.currentWins||0,\"-\",team.currentLosses||0]})]}),/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'right'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Rank\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{fontWeight:600},children:team.currentRank?\"#\".concat(team.currentRank):'NR'})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{minHeight:'32px',display:'flex',alignItems:'center',justifyContent:'center',gap:1},children:[team.isHuman&&/*#__PURE__*/_jsx(Chip,{icon:/*#__PURE__*/_jsx(Person,{}),label:\"Human\",size:\"small\",color:\"primary\",sx:{background:'linear-gradient(135deg, #1e88e5, #42a5f5)',color:'white'}}),(selectedTeam===null||selectedTeam===void 0?void 0:selectedTeam.id)===team.id&&/*#__PURE__*/_jsx(Star,{color:\"primary\"})]})]})]})})})},team.id))}),selectedTeam&&/*#__PURE__*/_jsx(motion.div,{variants:itemVariants,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.3},style:{position:'fixed',bottom:0,left:0,right:0,zIndex:1000},children:/*#__PURE__*/_jsx(Box,{sx:{background:'linear-gradient(135deg, rgba(10,14,39,0.7) 0%, rgba(26,29,53,0.75) 50%, rgba(36,39,68,0.8) 100%)',backdropFilter:'blur(25px)',borderTop:'1px solid rgba(255,255,255,0.15)',py:3,px:2,textAlign:'center',boxShadow:'0 -8px 32px rgba(0,0,0,0.3)'},children:/*#__PURE__*/_jsx(Container,{maxWidth:\"lg\",children:/*#__PURE__*/_jsxs(GlassCard,{hover:false,sx:{display:'inline-block',p:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{mb:2},children:[\"Selected: \",selectedTeam.name]}),/*#__PURE__*/_jsx(GradientButton,{size:\"large\",onClick:handleConfirmSelection,disabled:isSubmitting,children:isSubmitting?'Setting up...':'Start Managing Team'})]})})})})]})})});};export default TeamSelection;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}